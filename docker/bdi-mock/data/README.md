# How to generate test data

### Generate a test XML file
Create a test xml starting from structure of the file __TS-ITSADNN832912398-800.001.003-20251121-229-803.xml__ .
This is just a sample file containing test data.

### Zip the files
Once you created enough test file, you can zip them in one archive using :
```shell
zip test_archive.zip test1.xml test2.xml ...
```


### Generate test certificate
In this folder you can find already made test certificate, these are used for sign the zip file containing testing data from BDI.
To generate your personal public key and private key you can use the command:

```shell
openssl req -x509 -newkey rsa:4096 -keyout test_p_cert.key -out test_cert.crt -days 365 -nodes
```

### How to sign the zip test file with S/MIME
You can use your private and public keys to sign the zip test file using this command:
```shell
openssl smime -sign -in test.zip -nodetach -signer test_cert.crt -inkey test_cert.key -out test.zip.p7m
```
This command will generate a file __test.zip.p7m__, signed with your autogenerated keys.

### How to verify the signature
For test file generated with personal keys you must use this command with the option for specify the certificate used, 
because openssl will not be able to verify it:
```shell
 openssl smime -verify -in test.zip.p7m -CAfile test_cert.crt
```
With normal file you don't need to specify the cert file:
```shell
 openssl smime -verify -in real_file.zip.p7m
```